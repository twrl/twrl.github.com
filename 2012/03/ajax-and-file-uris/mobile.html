<!DOCTYPE html>
<html xmlns="http://www.w3.org/1999/xhtml">
<head>

	<title>twrl - Ajax and file&#58;// URIs</title>

	<meta charset="utf-8"/>
	<meta name="viewport" content="width=device-width, initial-scale=1"/>

	<link href='http://fonts.googleapis.com/css?family=Droid+Sans:400,700|Droid+Sans+Mono' rel='stylesheet' type='text/css'/>

	<link rel="stylesheet" href="/css/mobile.css" />
  <link rel="stylesheet" href="http://code.jquery.com/mobile/1.1.1/jquery.mobile.structure-1.1.1.min.css" />
	<link rel="stylesheet" href="/css/code.css" />
	<script src="http://code.jquery.com/jquery-1.7.1.min.js"></script>
	<script src="http://code.jquery.com/mobile/1.1.1/jquery.mobile-1.1.1.min.js"></script>

</head>
<body>

		<div data-role="page" data-add-back-btn="true" data-theme="f">
		<div data-role="header">
			<h1>Ajax and file&#58;// URIs</h1>
		</div>
		<div data-role="content">

			<p>Ajax is becoming the dominant method, if it isn&rsquo;t already, of getting data in and out of a web application. But Ajax is built on top of XMLHttpRequest, which as the name suggests is only really well defined if the underlying protocol is HTTP.</p>

<p>So what about local files? The new Filesystem API&rsquo;s are coming, but they sandbox us heavily. At least for the time being, if we want to muck about with self-modifying code or local file-based data sources we have to hack it, which means using any one of half a dozen browser and/or os specific methods.</p>

<p>I quite like having a consistent API to work with, which you can&rsquo;t easily have under these circumstances. Fortunately, the lovely folks at TiddlyWiki have provided <a href="http://jquery.tiddlywiki.org/twFile.html">a jQuery plugin</a> which abstracts their general purpose file load and save functionality, so you have a load and a save function exposed and how those are best implemented is determined for you automatically.</p>

<p>However, it&rsquo;s still not a single consistent API for getting data in and out. Having load and save methods for the local filesystem is lovely if all I want to do is load and save from the local filesystem, but what if I want to use a resource which may or may not be local. I would like to treat a directory full of JSON files on the local system the same as a REST interface on a remote server, and the only thing I want to change is the base URI.</p>

<p>jQuery now supports the <code>$.ajaxTransport</code> method, which allows us to define custom ways in which jQuery&rsquo;s <code>$.ajax</code> method is implemented for different circumstances. It&rsquo;s relatively easy to use this to intercept Ajax queries to file:// URIs, and translate them into load and save calls based on whether they&rsquo;re GET or PUT. I&rsquo;ve hacked together a <a href="https://github.com/twrl/tinker/blob/master/js/jquery/localJax.js">jQuery plugin</a> to do just that, remapping Ajax queries on local files to the equivalent calls on TiddlyWiki&rsquo;s twFile plugin.</p>

<p>As cool as this is, it&rsquo;s only half the story. We don&rsquo;t just use Ajax to GET and PUT to RESTful data, we use it for all sorts of other things. It makes no sense to define a behaviour for a POST to local files in general. However, Web Workers potentially change that. An Ajax post to a local javascript could be interpreted as a command to load that javascript as a web worker, and then pass the query data into the worker as a message and wait for a response. Or it could not. The scenario is rather complicated, but certainly worth thinking about.</p>


			<div data-role="collapsible" data-inset="true" data-content-theme="g">
				<h3>About this post</h3>

				<p>Published on <time pubdate>28 March, 2012</time></p>
				<p>Tags: <a href="/tags/ajax/mobile.html">Ajax</a>, <a href="/tags/javascript/mobile.html">Javascript</a>, <a href="/tags/jquery/mobile.html">jQuery</a>, <a href="/tags/programming/mobile.html">Programming</a></p>

				<p><a href="/2012/03/ajax-and-file-uris//index.html">Desktop view</a></p>
			</div> 
			<div data-role="collapsible" data-inset="true" data-content-theme="g">
				<h3>Comments</h3>

				<script type="text/javascript">
		    /* * * CONFIGURATION VARIABLES: EDIT BEFORE PASTING INTO YOUR WEBPAGE * * */
		    var disqus_shortname = 'twrl'; // required: replace example with your forum shortname
			var disqus_identifier = '/2012/03/ajax-and-file-uris/';

		    /* * * DON'T EDIT BELOW THIS LINE * * */
		    (function() {
		        var dsq = document.createElement('script'); dsq.type = 'text/javascript'; dsq.async = true;
		        dsq.src = 'http://' + disqus_shortname + '.disqus.com/embed.js';
		        (document.getElementsByTagName('head')[0] || document.getElementsByTagName('body')[0]).appendChild(dsq);
		    })();
		</script>
		<noscript>Please enable JavaScript to view the <a href="http://disqus.com/?ref_noscript">comments powered by Disqus.</a></noscript>
		<a href="http://disqus.com" class="dsq-brlink">comments powered by <span class="logo-disqus">Disqus</span></a>
			</div>
		</div>
	</div>


</body>
</html>
